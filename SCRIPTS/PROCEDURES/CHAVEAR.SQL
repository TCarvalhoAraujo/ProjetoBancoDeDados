DELIMITER $$
CREATE PROCEDURE CHAVEAR (IN ID INT)
BEGIN
    DECLARE ACESSO_PRIORITARIO_ATUAL VARCHAR(100);

    SELECT ACESSO_PRIORITARIO INTO ACESSO_PRIORITARIO_ATUAL
    FROM ATIVIDADES_RECENTES
    WHERE FK_ID_ARQUIVO = ID;

    IF ACESSO_PRIORITARIO_ATUAL IS NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Arquivo n√£o encontrado';
    ELSE
        IF ACESSO_PRIORITARIO_ATUAL = 'sim' THEN
            UPDATE ATIVIDADES_RECENTES
            SET ACESSO_PRIORITARIO = 'nao'
            WHERE FK_ID_ARQUIVO = ID;
        ELSE
            UPDATE ATIVIDADES_RECENTES
            SET ACESSO_PRIORITARIO = 'sim'
            WHERE FK_ID_ARQUIVO = ID;
        END IF;
    END IF;
END $$
DELIMITER ;
